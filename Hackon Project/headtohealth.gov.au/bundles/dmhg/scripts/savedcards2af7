(function(){function p(){o.addClass("email-button");y.removeAttr("aria-live");u.length?u.prop("checked",ContentCards.getShouldKeepSavedCardsForever()):ContentCards.setShouldKeepSavedCardsForever(!1)}function w(i){i&&i.length||l||(l=!0,n.addClass("no-cards"),t=t.replaceWith(n.data("banner-no-cards")),n.find(".text-image-item-banner input").parent().hide(),v.remove(),c&&(t=n.find(".text-image-item-banner"),t.attr("tabindex",-1),t.focus(),setTimeout(function(){t.removeAttr("tabindex")},500)))}var n=$("#saved-cards"),t=n.find(".text-image-item-banner"),h=n.find(".clear-button-container > button"),r=n.find(".actions-container"),e=r.children("div"),i=r.children("button"),o=r.find(".action-email-button-container > button"),s=r.find(".action-link-button-container > button"),a=r.find(".close-actions-button"),u=t.find("input"),v=n.find("div.content"),b=u.parent(),y=$(".content-cards"),c=!1,l=!1,f;r.on("saved-cards-updated",function(n,t){w(t)});$(document).on("click","*",function(n){$(n.target).closest(e).length||$(n.target).closest(i).length||i.removeClass("active")});i.on("click",function(n){n.preventDefault();$(this).toggleClass("active");$(this).is(".active")&&e.focus()});h.on("click",function(n){n.preventDefault();ContentCards.showSavedCardsClearModal(h,function(){c=!0;ContentCards.putSavedCards([]);$(this).removeData("element-to-focus-after-hide")})});s.on("click",function(n){n.preventDefault();ContentCards.showSavedCardsLinkModal(s)});a.on("click",function(n){n.preventDefault();i.removeClass("active")});e.off("keydown").on("keydown",function(n){n.keyCode===Constants.KeyCode.Escape&&(n.stopPropagation(),n.preventDefault(),i.removeClass("active"),i.focus())});u.on("change",function(n){n.preventDefault();n.stopImmediatePropagation();ContentCards.setShouldKeepSavedCardsForever(u.is(":checked"))});$(document).on("shown.bs.modal",".modal",function(){var n=$(this).data("element-to-focus-after-hide")||$();(n.is(o)||n.is(s))&&$(this).data("element-to-focus-after-hide",i)});$(document).ready(function(){ContentCards.haveSavedCards()&&(f=new SearchModel(new FilterModel("",Constants.SearchType.SearchService)),f.IsSavedCardsPage(!0),ko.applyBindings(f),$.ajax({url:"/dmhgapi/SavedCard/GetCards",method:"POST",dataType:"json",data:JSON.stringify({CardIdList:ContentCards.getSavedCards()}),contentType:"application/json; charset=utf-8"}).done(function(n){n.Pagination={Total:0,PageSize:0,CurrentPage:0};f.MapJsonToCards(n)}),o.data("searchModel",f))});n.on("focus",function(){n.attr("tabindex")&&n.removeAttr("tabindex")});p()})();